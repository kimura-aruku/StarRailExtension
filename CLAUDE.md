# CLAUDE.md

このファイルは、このリポジトリでコードを操作する際のClaude Code (claude.ai/code)へのガイダンスを提供します。

## プロジェクト概要

これは崩壊：スターレイルの戦績ページ（https://act.hoyolab.com/app/community-game-records-sea/rpg/index.html）でスコアを計算して表示するChrome拡張機能です。この拡張機能は、一般的に使用されている簡略化された計算式ではなく、正確な計算方式を使用します。

## アーキテクチャ

### ファイル構成
- `manifest.json` - Chrome拡張機能のマニフェスト（v3）
- `content.js` - スコア計算機能を注入するメインのコンテンツスクリプト
- `README.md` - 日本語のプロジェクトドキュメント
- `Images/` - スクリーンショット素材（導入前後の画像）

### 主要コンポーネント

**コンテンツスクリプト (`content.js`)**
- HoyoLab戦績ページでdocument_startで実行される
- MutationObserverを使用してページの変更とキャラクター切り替えを監視
- ユーザーがハイライトした有効サブステータスに基づいてスコアを計算
- 既存のページ構造にスコア表示要素を注入

**スコア計算ロジック**
- 特定の計算式を使用: 会心ダメージ : 会心率 : 攻撃力%（HP%） = 1 : 2 : 1.5
- カスタムサブステータス選択からハイライトされた「有効サブステータス」のみをカウント
- 速度の計算式: (64.8/25.0) * 速度値
- 実数値ステータス（パーセンテージでないHP、攻撃力、防御力）のスコアは0

## 開発コマンド

このプロジェクトはビルドシステムを使用しません。ソースファイルを直接編集して開発します：

1. Chromeでパッケージ化されていない拡張機能を読み込み: `chrome://extensions` → デベロッパーモードを有効 → パッケージ化されていない拡張機能を読み込む
2. 変更後に拡張機能を再読み込み: 拡張機能カードの再読み込みボタンをクリック
3. デバッグ: 対象ページでChrome DevToolsを使用

## 対象ウェブサイト統合

拡張機能は以下のURLでのみ動作します: `https://act.hoyolab.com/app/community-game-records-sea/rpg/index.html*`

拡張機能が操作する主要なDOM要素:
- `.pc-swiper-block-layout__content` - キャラクター情報コンテナ
- `.c-hrd-ri-name` - キャラクター名要素
- `.c-hrdr-item` - 遺物要素
- `.c-hrdr-btm-item` - 個別ステータス行
- `.c-hrdr-num[highlight="true"]` - ハイライトされた有効サブステータス

## 重要な注意事項

- 拡張機能は戦績が「数値」モード（「簡略」モードではない）である必要があります
- カスタムサブステータスパネルからハイライトされたサブステータスのみでスコアを計算します
- 日本語文字列を使用し、現在は日本語のみ対応
- 注入される全ての要素は識別とクリーンアップのためにCSSクラス`alk-element`を使用
- 動的コンテンツの読み込みとユーザー操作を処理するためにmutation observerを使用